const redeemedData = {
    missions: {
        title: '57 Story Missions',
        desc: 'Complete all story missions',
        items: [
            'Exodus in America', 'New Friends, Old Problems', 'Obstacles in Our Path',
            'This is Armadillo, USA', 'Women and Cattle', 'Wild Horses, Tamed Passions',
            'A Tempest Looms', 'The Burning', 'Political Realities in Armadillo',
            'Justice in Pike\'s Basin', 'Spare the Rod, Spoil the Bandit', 'Hanging Bonnie MacFarlane',
            'The Assault on Fort Mercer', 'Old Swindler Blues', 'You Shall Not Give False Testimony, Except for Profit',
            'Liars, Cheats and Other Proud Americans', 'Can a Swindler Change His Spots?', 'The Sport of Kings, and Liars',
            'Exhuming and Other Fine Hobbies', 'A Gentle Drive with Friends', 'Let the Dead Bury Their Dead',
            'A Frenchman, a Welshman and an Irishman', 'Man is Born Unto Trouble', 'On Shaky\'s Ground',
            'We Shall Be Together in Paradise', 'Civilization, at any price', 'The Demon Drink',
            'Empty Promises', 'Mexican Caesar', 'Cowards Die Many Times',
            'The Gunslinger\'s Tragedy', 'Landon Ricketts Rides Again', 'Lucky in Love',
            'The Mexican Wagon Train', 'My Sister\'s Keeper', 'Must a Saviour Die?',
            'Father Abraham', 'Captain De Santa\'s Downfall', 'The Great Mexican Train Robbery',
            'The Gates of El Presidio', 'An Appointed Time', 'Bear One Another\'s Burdens',
            'Great Men are Not Always Wise', 'And You Will Know The Truth', 'And The Truth Will Set You Free',
            'At Home with Dutch', 'For Purely Scientific Purposes', 'The Prodigal Son Returns (To Yale)',
            'The Outlaw\'s Return', 'Pestilence', 'Old Friends, New Problems',
            'By Sweat and Toil', 'A Continual feast', 'John Marston and Son',
            'Wolves, Dogs and Sons', 'Spare the Love, Spoil the Child', 'The Last Enemy That Shall Be Destroyed'
        ]
    },
    rareWeapons: {
        title: '5 Rare Weapons',
        desc: 'Purchase all rare weapons from gunsmiths',
        items: [
            'Mauser Pistol - $800 - Blackwater Gunsmith',
            'Carcano Rifle - $1100 - Blackwater Gunsmith',
            'Semi Automatic Shotgun - $1000 - Escalera Gunsmith',
            'Evans Repeater - $1000 - Blackwater Gunsmith',
            'LeMat Revolver - $1250 - Escalera Gunsmith'
        ]
    },
    outfits: {
        title: '9 Outfits',
        desc: 'Collect all outfit scraps and unlock outfits',
        items: [
            'U.S Army Outfit',
            'U.S Marshall Outfit',
            'Elegant Suit',
            'Rancher Outfit',
            'Mexican Poncho',
            'Bollard Twins Outfit',
            'Treasure Hunter Outfit',
            'Bandito Outfit',
            'Reyes\' Rebels Outfit'
        ]
    },
    jobs: {
        title: '5 Jobs',
        desc: 'Complete one of each job type',
        items: [
            'MacFarlanes Ranch Nightwatch',
            'Chuparosa Nightwatch',
            'Blackwater Nightwatch',
            'Ridgewood Farm Horsebreaking',
            'Chuparosa Horsebreaking'
        ]
    },
    hideouts: {
        title: '8 Gang Hideouts',
        desc: 'Clear all gang hideouts',
        items: [
            'Fort Mercer',
            'Gaptooth Breach',
            'Tumbleweed',
            'Pike\'s Basin',
            'Twin Rocks',
            'Solomon\'s Folly',
            'Nosaldia',
            'Tesoro Azul'
        ]
    },
    houses: {
        title: '13 Player Houses',
        desc: 'Purchase or unlock all safehouses',
        items: [
            'MacFarlanes Ranch - Free',
            'Armadillo - $50',
            'Thieve\'s Landing - $100',
            'Rathskeller Fork - $100',
            'Irish\'s Shack - Free',
            'Escalera - $150',
            'Chuparosa - $200',
            'Casa Madrugada - $250',
            'El Matadero - $150',
            'Blackwater - Free',
            'Manzanita Post - $400',
            'Beecher\'s Hope - Free',
            'Jack\'s Bed - Free'
        ]
    },
    bounties: {
        title: '20 Bounties',
        desc: 'Complete bounties across all regions',
        items: [
            'New Austin Bounty 1', 'New Austin Bounty 2', 'New Austin Bounty 3', 'New Austin Bounty 4',
            'New Austin Bounty 5', 'New Austin Bounty 6', 'New Austin Bounty 7', 'New Austin Bounty 8',
            'Mexico Bounty 1', 'Mexico Bounty 2', 'Mexico Bounty 3', 'Mexico Bounty 4',
            'Mexico Bounty 5', 'Mexico Bounty 6', 'Mexico Bounty 7', 'Mexico Bounty 8',
            'West Elizabeth Bounty 1', 'West Elizabeth Bounty 2', 'West Elizabeth Bounty 3', 'West Elizabeth Bounty 4'
        ]
    },
    strangers: {
        title: '18 Stranger Missions',
        desc: 'Complete all stranger mission chains',
        items: [
            'American Appetites',
            'California',
            'Flowers For a Lady',
            'Funny Man',
            'Jenny\'s Faith',
            'Let No Man Put Asunder',
            'Lights, Camera, Action',
            'Water and Honesty',
            'American Lobbyist',
            'Remember My Family',
            'The Wronged Woman',
            'The Prohibitionist',
            'Aztec Gold',
            'Poppycock',
            'Love is the Opiate',
            'Eva In Peril',
            'Deadalus and Son',
            'Who Are you to Judge?'
        ]
    },
    minigames: {
        title: '6 Minigames',
        desc: 'Win each minigame at least once',
        items: [
            'Five Finger Fillet',
            'Arm Wrestling',
            'Blackjack',
            'Horseshoes',
            'Poker',
            'Liar\'s Dice'
        ]
    },
    locations: {
        title: '94 Locations',
        desc: 'Discover all locations (buy maps from general stores)',
        items: [
            'Hennigan\'s Stead (16 locations)', 'Cholla Springs (17 locations)',
            'Gaptooth Ridge (7 locations)', 'Rio Bravo (7 locations)',
            'Punta Orgullo (9 locations)', 'Perido (14 locations)',
            'Diez Coronas (9 locations)', 'Great Plains (4 locations)',
            'Tall Trees (11 locations)'
        ]
    },
    challenges: {
        title: '8 Challenges (Ranks 1-10)',
        desc: 'Complete all challenge ranks',
        items: [
            'Master Hunter Rank 1-5',
            'Master Hunter Rank 6-10',
            'Sharpshooter Rank 1-5',
            'Sharpshooter Rank 6-10',
            'Treasure Hunter Rank 1-5',
            'Treasure Hunter Rank 6-10',
            'Survivalist Rank 1-5',
            'Survivalist Rank 6-10'
        ]
    }
};

let progress = {};
let expandedSections = {};

// Load saved progress
function loadProgress() {
    const saved = window.localStorage.getItem('rdrRedeemedProgress');
    if (saved) {
        progress = JSON.parse(saved);
    } else {
        // Initialize progress
        Object.keys(redeemedData).forEach(sectionKey => {
            progress[sectionKey] = {};
            redeemedData[sectionKey].items.forEach(item => {
                progress[sectionKey][item] = false;
            });
        });
    }
}

// Save progress
function saveProgress() {
    window.localStorage.setItem('rdrRedeemedProgress', JSON.stringify(progress));
    updateProgress();
}

// Toggle item
function toggleItem(sectionKey, item) {
    progress[sectionKey][item] = !progress[sectionKey][item];
    saveProgress();
    renderChecklist();
}

// Toggle section expansion
function toggleSection(sectionKey) {
    expandedSections[sectionKey] = !expandedSections[sectionKey];
    renderChecklist();
}

// Update overall progress
function updateProgress() {
    let totalItems = 0;
    let completedItems = 0;

    Object.keys(redeemedData).forEach(sectionKey => {
        const section = redeemedData[sectionKey];
        totalItems += section.items.length;
        completedItems += Object.values(progress[sectionKey]).filter(Boolean).length;
    });

    const percentage = Math.round((completedItems / totalItems) * 100);

    document.getElementById('redeemedProgress').style.width = percentage + '%';
    document.getElementById('redeemedProgressText').textContent = percentage + '%';
    document.getElementById('completedCount').textContent = completedItems;
    document.getElementById('remainingCount').textContent = totalItems - completedItems;
    document.getElementById('totalCount').textContent = totalItems;
}

// Render checklist
function renderChecklist() {
    const container = document.getElementById('checklistContainer');
    container.innerHTML = '';

    Object.keys(redeemedData).forEach(sectionKey => {
        const section = redeemedData[sectionKey];
        const sectionProgress = progress[sectionKey];
        const completed = Object.values(sectionProgress).filter(Boolean).length;
        const total = section.items.length;
        const isExpanded = expandedSections[sectionKey];

        const sectionDiv = document.createElement('div');
        sectionDiv.className = 'checklist-section';

        let content = `
            <div class="section-header" onclick="toggleSection('${sectionKey}')">
                <div>
                    <div class="section-title">${section.title}</div>
                    <div style="font-size: 0.85em; opacity: 0.8; margin-top: 4px;">${section.desc}</div>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div class="section-count">${completed}/${total}</div>
                    <span class="expand-icon ${isExpanded ? 'expanded' : ''}">▼</span>
                </div>
            </div>
        `;

        if (isExpanded) {
            content += `<div class="section-items expanded">`;
            section.items.forEach(item => {
                const isCompleted = sectionProgress[item];
                content += `
                    <div class="checklist-item ${isCompleted ? 'completed' : ''}" onclick="toggleItem('${sectionKey}', '${item.replace(/'/g, "\\'")}')">
                        <div class="item-checkbox">
                            <span class="checkmark">✓</span>
                        </div>
                        <div class="item-content">
                            <div class="item-title">${item}</div>
                        </div>
                    </div>
                `;
            });
            content += `</div>`;
        }

        sectionDiv.innerHTML = content;
        container.appendChild(sectionDiv);
    });
}

// Initialize
loadProgress();
renderChecklist();
updateProgress();